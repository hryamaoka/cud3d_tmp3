# `src/engine/raycast_utils.c` 詳細解説

## 概要
レイキャスティングで使用されるDDAアルゴリズムと、レイの補助計算関数です。

## コード詳細解説

| 行番号 | コード | 解説 |
| :--- | :--- | :--- |
| **15** | `void perform_dda(t_game *game)` | **DDA実行**<br>レイがマップ上の壁に衝突するまでステップを進めます。 |
| **16** | `  while (game->ray.hit == 0)` | 衝突フラグが立つまでループ。 |
| **17-25** | `    if (side_dist_x < side_dist_y) ...` | **DDAロジック**<br>次のグリッド境界までの距離が近い方の軸（X or Y）を一歩進めます。これによりグリッドを正確にトレースします。`side`変数で衝突面（0:東西, 1:南北）を記録します。 |
| **31-33** | `    if (... == '1' || ... == 'D')` | **衝突判定**<br>現在位置が壁('1')またはドア('D')であればヒットとみなします。 |
| **37** | `void select_texture(t_game *game, t_img **tex)` | **テクスチャ選択**<br>衝突状況に基づいて描画に使用するテクスチャ画像を決定します。 |
| **38** | `  if (... == 'D')` | ドアの場合。 |
| **40-42** | `  else if (side == 0) ...` | X面ヒットかつレイが正方向なら東(EA)、負なら西(WE)。 |
| **46-48** | `  else ...` | Y面ヒットかつレイが正方向なら南(SO)、負なら北(NO)。 |
| **53/65** | `void init_ray_step_x/y(...)` | **初期ステップ計算**<br>レイの開始時に、最初のグリッド境界までの距離(`side_dist`)と進行方向(`step`)を設定します。 |
