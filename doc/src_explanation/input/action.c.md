# `src/input/action.c` 詳細解説

## 概要
ユーザーからのアクション入力（ドアの開閉など）や、キー入力全体の振り分け処理を担当します。

## 依存関係
*   `input.h`: 入力関連関数プロトタイプ。
*   `keys.h`: キーコード定義（`KEY_W`, `KEY_ESC` 等）。

## 関数詳細

### 1. `interact_door`
#### プロトタイプ
`void interact_door(t_game *game)`

#### 戻り値
なし

#### 解説
プレイヤーの目の前（向いている方向の1マス先）にあるドアを開閉します。
*   対象が閉じたドア(`D`)なら、開いたドア(`O`)に変更します。
*   対象が開いたドア(`O`)なら、閉じたドア(`D`)に変更します。
    *   ただし、プレイヤー自身がそのドアのマスに立っている場合は、閉じると挟まってしまうため何もしません。

### 2. `key_press`
#### プロトタイプ
`int key_press(int keycode, t_game *game)`

#### 戻り値
常に `0`。

#### 解説
`mlx_hook` に登録されるキー入力コールバック関数です。押されたキーコードに応じて適切なアクション関数（移動、回転、終了、ドア操作）を呼び出します。

### コード行別解説 (`interact_door`)

| 行番号 | コード | 詳細解説 |
| :--- | :--- | :--- |
| 22-23 | `target_x = ...` | **対象座標計算**<br>プレイヤーの現在位置ベクトルに方向ベクトルを足すことで、「目の前のマス」の座標を求めます。 |
| 24-25 | `if (target_x >= 0 ...)` | **範囲外チェック**<br>目の前がマップ外でないことを確認します。 |
| 27 | `... = 'O';` | ドアを開けます。 |
| 29 | `if (...) return;` | **挟まり防止**<br>プレイヤーがドアと同じマスにいる場合、閉じる動作をキャンセルします。 |
