# `src/parser/check_file.c` 詳細解説

## 概要
コマンドライン引数として渡されたファイル名が有効な形式（`.cub`拡張子）であるかを検証します。この検証を行わないと、意図しないバイナリファイルや無関係なテキストファイルを読み込もうとして予期せぬ動作を引き起こす可能性があります。

## 依存関係
*   `cub3d.h`: プロジェクト共通の型定義やマクロ。
*   `libft.h`: `ft_strrchr`, `ft_strncmp` 等の文字列操作関数。

## 関数詳細: check_filename

### プロトタイプ
`int check_filename(char *filename)`

### 戻り値
*   `1`: ファイル名が有効（.cub で終わっている）。
*   `0`: ファイル名が無効（NULL、拡張子なし、または拡張子が .cub ではない）。

### コード行別解説

| 行番号 | コード | 詳細解説 |
| :--- | :--- | :--- |
| 15 | `int check_filename(char *filename)` | **ファイル名検証関数**<br>引数で渡されたパスが有効な拡張子を持つか確認します。 |
| 19-20 | `if (!filename) return (0);` | **NULLチェック**<br>引数が `NULL` の場合（通常はあり得ませんが防御的記述）、`0` を返します。 |
| 21 | `extention = ft_strrchr(filename, '.');` | **拡張子検索**<br>文字列の**最後**にあるドット `.` を検索します。`ft_strchr`（前方検索）ではなく `ft_strrchr`（後方検索）を使うのは、`map.v2.cub` のようなファイル名でも正しく最後のドットを取得するためです。 |
| 22-23 | `if (!extention) return (0);` | ドットが見つからない（拡張子がない）場合はエラーとして `0` を返します。 |
| 24 | `diff = ft_strncmp(extention, ".cub", 5);` | **拡張子比較**<br>取得したポインタ位置以降の文字列と `".cub"` を比較します。長さ `5` （4文字 + 終端NULL）を指定することで、完全一致を確認します。これにより `.cuba` のような誤った拡張子を排除します。 |
| 25-26 | `if (diff) return (0);` | 一致しない（差分がある）場合はエラー。 |
| 27 | `return (1);` | 全てのチェックを通過した場合、有効なファイル名として `1` を返します。 |
