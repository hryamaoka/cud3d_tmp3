# `src/parser/parse_textures.c` 詳細解説

## 概要
テクスチャパスを指定する行（例: `NO ./path/to/texture.xpm`）を解析し、構造体にパスを保存します。指定されたパスが `.xpm` 拡張子を持っているかも簡易チェックします。

## 依存関係
*   `parse.h`: パース用ヘッダ。
*   `libft.h`: `ft_split`, `ft_strncmp`, `ft_strdup`, `ft_strlen` 等。

## 関数詳細

### 1. `set_texture`
#### プロトタイプ
`static int set_texture(char **texture, char *path)`

#### 戻り値
*   `1`: 正常に設定完了。
*   `0`: 既に設定済み、またはパスが不正（拡張子エラー等）。

#### 解説
パス文字列の末尾にある改行や空白を除去し、拡張子が `.xpm` であるかを確認してから、`ft_strdup` でメモリを確保して構造体に保存します。重複定義（既に値が入っている場合）はエラーとします。

### 2. `parse_texture`
#### プロトタイプ
`int parse_texture(char *line, t_game *game)`

#### 戻り値
*   `1`: テクスチャ行として認識・処理された。
*   `0`: テクスチャ行ではない（識別子が合わない）、またはフォーマットエラー。

#### 解説
行をスペースで分割し、最初の単語が識別子（NO, SO, WE, EA）であるかを確認します。一致する場合、2番目の単語をパスとして `set_texture` に渡します。

### コード行別解説 (`parse_texture`)

| 行番号 | コード | 詳細解説 |
| :--- | :--- | :--- |
| 38 | `split = ft_split(line, ' ');` | **行分割**<br>スペース区切りでトークンに分割します。タブは考慮されていない点に注意が必要ですが、課題要件的にはスペース区切りが基本です。 |
| 39-42 | `if (!split ...)` | 分割失敗、またはトークンが不足している（パスがない）場合はエラー。 |
| 44-49 | `if (!ft_strncmp("NO", split[0], 3))` | **北テクスチャ判定**<br>識別子が "NO" かチェックします。長さ3で比較して完全一致を見ます。 |
| 45 | `if (!set_texture(&game->tex.no, split[1]))` | パスを設定しようと試みます。失敗（重複や拡張子違い）ならエラー処理へ。 |
| 47 | `perror_and_exit("Invalid NO texture", game);` | 設定失敗時は即座にプログラムを終了させます。 |
| 50-68 | `else if ...` | 南(SO)、西(WE)、東(EA) について同様の処理を行います。 |
| 69 | `free_split(split);` | 一時的に確保した分割配列を解放してメモリリークを防ぎます。 |
| 70 | `return (ret);` | 処理結果（見つかった場合は1、それ以外は0）を返します。 |
