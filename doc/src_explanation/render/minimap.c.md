# `src/render/minimap.c` 詳細解説

## 概要
画面上に小さな2Dマップ（ミニマップ）を描画します。現在のプレイヤー位置と周囲の壁・床の配置を俯瞰視点で表示することで、探索を補助するボーナス機能です。

## 依存関係
*   `render.h`: `MM_SCALE`, `MM_OFFSET_X` などの定数定義。

## 関数詳細

### 1. `draw_rect`
#### プロトタイプ
`static void draw_rect(t_game *game, int x, int y, int size, int color)`

#### 戻り値
なし

#### 解説
指定された座標 `(x, y)` を左上とする `size x size` の正方形を塗りつぶします。
各ピクセルを描画する前に、画面外へのはみ出しチェック（クリッピング）を行い、安全な場合のみ `game->img.addr` に色データを書き込みます。

### 2. `draw_minimap`
#### プロトタイプ
`void draw_minimap(t_game *game)`

#### 戻り値
なし

#### 解説
ミニマップ全体を描画します。
1.  **地形描画**: マップ配列 `game->map.grid` を走査し、壁(`1`)なら壁色、それ以外（床やアイテム）なら床色の正方形を描画します。
2.  **プレイヤー描画**: プレイヤーの現在位置 `(game->player.x, y)` に基づき、地形の上に重ねてプレイヤーを示す小さな正方形を描画します。

### コード行別解説 (`draw_minimap`)

| 行番号 | コード | 詳細解説 |
| :--- | :--- | :--- |
| 49-51 | `while (map_y < ...)` | **2重ループ**<br>マップの全マスを走査します。 |
| 52-53 | `draw_x = MM_OFFSET_X + ...` | **描画位置計算**<br>画面上のオフセット位置を基準に、マップ座標をスケーリング（`MM_SCALE`倍）して描画座標に変換します。 |
| 55-58 | `if (!game->map.grid[map_y])` | 行データが存在しない場合（パースミス等への防御）、ループを抜けます。 |
| 62 | `draw_rect(..., MM_COLOR_WALL);` | 壁の描画。 |
| 64 | `draw_rect(..., MM_COLOR_FLOOR);` | 床の描画（スペース ` ` 以外の全ての文字）。 |
| 72-73 | `int px = ...` | **プレイヤー位置**<br>プレイヤーの実座標（小数）をピクセル座標に変換し、自身のサイズ分だけずらして中心に合わせます。 |
