# `src/parser/parse_map.c` 詳細解説

## 概要
マップ部分の行読み込み、メモリ確保、矩形補正（正規化）を行います。

## コード詳細解説

| 行番号 | コード | 解説 |
| :--- | :--- | :--- |
| **15** | `static int process_map_line(...)` | **行ごとの処理**<br>読み込んだ行をマップ配列に追加します。最大幅(`max_width`)の更新も行います。 |
| **19** | `  if (is_empty_line(line))` | **空行検出**<br>マップ読み込み中に空行が現れた場合、それ以降にマップデータがあってはいけません（分離マップ禁止）。`map_ended`フラグを立てて管理します。 |
| **33** | `  *temp_map = change_line_to_map(...)` | 配列サイズを拡張して新しい行を追加します（`realloc`相当の自作関数）。 |
| **42** | `static int normalize_map(...)` | **矩形化**<br>全ての行の長さを最長行(`max_width`)に合わせます。短い行の余白はスペースで埋めます。これにより配列アクセスが安全になります。 |
| **65** | `static int read_lines(...)` | **読み込みループ**<br>`get_next_line`を繰り返し呼び出し、EOFまでマップデータを蓄積します。 |
| **83** | `int parse_map(...)` | **全体制御**<br>`read_lines`で生データを読み込み、`normalize_map`で整形して`game`構造体に格納します。 |
